<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>TEST - Encuadre del Mapa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html, body {
      height: 100vh; width: 100vw; margin: 0; padding: 0; background: #0b1021;
    }
    #map { width: 100vw; height: 100vh; }
    
    /* M√°rgenes negros laterales para ocultar repetici√≥n */
    .map-margin-left, .map-margin-right {
      position: absolute;
      top: 0;
      height: 100vh;
      width: 12%;
      background: #0b1021;
      z-index: 1000;
      pointer-events: none;
      box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.8);
    }
    .map-margin-left { left: 0; }
    .map-margin-right { right: 0; }
    
    #controls {
      position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
      z-index: 2000; background: rgba(11, 16, 33, 0.95);
      border: 2px solid #13f5ff; border-radius: 12px; padding: 15px;
      color: #fff; font-family: 'Consolas', monospace;
      max-width: 500px;
    }
    #info {
      margin-top: 10px; font-size: 0.9em; color: #13f5ff;
      background: rgba(19, 245, 255, 0.1); padding: 10px; border-radius: 6px;
    }

    /* Ticker de noticias simulado */
    #noticias-ticker {
      position: absolute; bottom: 0; left: 0; width: 100vw;
      z-index: 3000; background: rgba(8, 26, 31, 0.54);
      color: #6bf; font-family: 'Segoe UI', Arial, sans-serif; font-size: 1.13em;
      height: 33px; display: flex; align-items: center; overflow: hidden;
      border-top: 2px solid #13f5ff;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  
  <!-- Ticker simulado (como en el mapa principal) -->
  <div id="noticias-ticker">
    <span style="padding: 0 20px;">üì∞ Ticker de noticias (simulado para prueba de viewport)</span>
  </div>
  
  <!-- M√°rgenes negros laterales -->
  <div class="map-margin-left"></div>
  <div class="map-margin-right"></div>
  
  <div id="controls">
    <h3 style="margin: 0 0 10px 0; color: #13f5ff;">üß™ TEST - Ajusta el Encuadre Perfecto</h3>
    <div style="background: rgba(76, 175, 80, 0.15); padding: 10px; border-radius: 6px; font-size: 0.85em; line-height: 1.6; border: 1px solid #4caf50;">
      ‚ú® <strong>MODO LIBRE:</strong><br>
      üîÑ Mundo infinito (sin l√≠mites laterales)<br>
      üîç Zoom EXTRA SUAVE (pasos de 0.005)<br>
      üéÆ <strong>Arrastra y zoom</strong> con precisi√≥n<br>
      üì∏ <strong>Copia coordenadas</strong> cuando est√© perfecto
    </div>
    <div style="margin-top: 10px;">
      <button onclick="captureConfig()" style="padding: 12px; width: 100%; background: #4caf50; border: 2px solid #4caf50; color: #fff; cursor: pointer; border-radius: 8px; font-weight: bold; font-size: 1em;">
        ‚úÖ CAPTURAR CONFIGURACI√ìN
      </button>
      <div style="font-size: 0.75em; margin-top: 5px; color: #4caf50;">
        Cuando est√© perfecto, click aqu√≠ para capturar todos los datos
      </div>
    </div>
    <div id="info">
      <strong>Centro:</strong> [35.0000, 15.0000]<br>
      <strong>Zoom:</strong> 3.00<br>
      <strong>noWrap:</strong> <span id="current-nowrap">false</span>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('map', {
      zoomControl: true,
      attributionControl: false,
      minZoom: 1,
      maxZoom: 17,
      scrollWheelZoom: true,
      dragging: true,
      zoomSnap: 0.005,
      zoomDelta: 0.005,
      wheelPxPerZoomLevel: 600,
      noWrap: false,
      worldCopyJump: true
    });

    map.setView([28.0148, 13.4017], 2.33);
    
    console.log('üéÆ MODO LIBRE TOTAL:');
    console.log('  Movimiento lateral SIN l√≠mites');
    console.log('  Zoom EXTRA SUAVE (0.005 - cada scroll cambia MUY poco)');
    console.log('  M√°rgenes laterales al 12%');
    console.log('  ');
    console.log('üì∏ Cuando est√© perfecto, click en "CAPTURAR CONFIGURACI√ìN"');

    // Mapa base oscuro - CON REPETICI√ìN
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 19, minZoom: 1, noWrap: false
    }).addTo(map);

    // Capa GPS - CON REPETICI√ìN
    L.tileLayer('https://gps-{s}.tile.openstreetmap.org/lines/{z}/{x}/{y}.png', {
      maxZoom: 19, minZoom: 1, opacity: 0.85, noWrap: false
    }).addTo(map);

    // L√≠neas de zonas horarias (para referencia)
    for(let i = -12; i <= 14; i++) {
      const lon = i * 15;
      if (lon < -180 || lon > 180) continue;
      L.polyline([[-59.98, lon], [82.26, lon]], {
        color: "#2cfdff", weight: 2, opacity: 0.5, dashArray: "5,14"
      }).addTo(map);
    }

    function captureConfig() {
      const center = map.getCenter();
      const zoom = map.getZoom();
      const bounds = map.getBounds();
      
      console.log('\n' + '='.repeat(60));
      console.log('üì∏ CONFIGURACI√ìN CAPTURADA:');
      console.log('='.repeat(60));
      console.log(`Centro: [${center.lat.toFixed(4)}, ${center.lng.toFixed(4)}]`);
      console.log(`Zoom: ${zoom.toFixed(2)}`);
      console.log(`Bounds visibles:`);
      console.log(`  Sur-Oeste: [${bounds.getSouthWest().lat.toFixed(2)}, ${bounds.getSouthWest().lng.toFixed(2)}]`);
      console.log(`  Nor-Este: [${bounds.getNorthEast().lat.toFixed(2)}, ${bounds.getNorthEast().lng.toFixed(2)}]`);
      console.log(`Ancho margen lateral: 12%`);
      console.log('='.repeat(60));
      console.log('‚úÖ Copia estos datos y p√©gamelos en el chat');
      console.log('='.repeat(60) + '\n');
      
      alert('‚úÖ Configuraci√≥n capturada en la consola!\n\nCopia los datos de la consola y p√©galos en el chat.');
    }

    function updateInfo() {
      const center = map.getCenter();
      const zoom = map.getZoom();
      document.getElementById('info').innerHTML = 
        `<strong>Centro:</strong> [${center.lat.toFixed(4)}, ${center.lng.toFixed(4)}]<br>` +
        `<strong>Zoom:</strong> ${zoom.toFixed(2)}<br>` +
        `<strong>noWrap:</strong> <span id="current-nowrap">${currentNoWrap}</span>`;
      console.log(`üìç Centro: [${center.lat.toFixed(4)}, ${center.lng.toFixed(4)}], Zoom: ${zoom.toFixed(2)}, noWrap: ${currentNoWrap}`);
    }

    // Actualizar info en tiempo real
    map.on('moveend zoomend', updateInfo);

    console.log('üß™ TEST DE ENCUADRE - MODO INFINITO');
    console.log('üéÆ Arrastra y haz zoom hasta que se vea perfecto');
    console.log('üîÑ Usa el bot√≥n para probar con noWrap true/false');
    console.log('üìç Las coordenadas se actualizan autom√°ticamente');
    console.log('üì∏ Copia las coordenadas cuando est√© perfecto');
    
    // Trigger inicial
    updateInfo();
  </script>
</body>
</html>
